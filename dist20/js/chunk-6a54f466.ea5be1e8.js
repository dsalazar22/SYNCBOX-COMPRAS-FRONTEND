(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6a54f466"],{"0b4b":function(t,e,n){},"60bc":function(t,e,n){"use strict";var i=n("0b4b"),a=n.n(i);a.a},7187:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h4",{staticClass:"font-weight-bold py-3 mb-4"},[t._v("Control de Solicitudes")]),t._v(" "),n("div",{staticClass:"w-100 text-right"}),t._v(" "),n("div",{staticClass:"text-right"},[n("label",{staticClass:"switcher switcher-success"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.active_requests,expression:"active_requests"}],staticClass:"switcher-input",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(t.active_requests)?t._i(t.active_requests,null)>-1:t.active_requests},on:{change:[function(e){var n=t.active_requests,i=e.target,a=!!i.checked;if(Array.isArray(n)){var o=null,s=t._i(n,o);i.checked?s<0&&(t.active_requests=n.concat([o])):s>-1&&(t.active_requests=n.slice(0,s).concat(n.slice(s+1)))}else t.active_requests=a},function(e){return t.changeRequestsState(t.active_requests)}]}}),t._v(" "),t._m(0),t._v(" "),n("span",{staticClass:"switcher-label"},[t._v("Ver Solicitudes Activas")])]),t._v(" "),n("b-btn",{staticClass:"btn-sm",attrs:{variant:"outline-success borderless"},on:{click:function(e){return e.preventDefault(),t.newRequest()}}},[n("span",{staticClass:"ion ion-md-add"}),t._v("  Adicionar Nueva Solicitud\n                    ")])],1),t._v(" "),n("b-modal",{attrs:{"hide-footer":"",size:"xl"},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v("\n            Creación de Solicitud\n        ")]},proxy:!0}]),model:{value:t.mantConfig,callback:function(e){t.mantConfig=e},expression:"mantConfig"}},[t._v(" "),n("b-form-group",{attrs:{label:"Seleccione un Activo"}},[n("multiselect",{attrs:{options:t.tableAssets,placeholder:"Seleccione un Activo",label:"code","track-by":"code"},model:{value:t.objinfo,callback:function(e){t.objinfo=e},expression:"objinfo"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-md":"5","label-cols-lg":"3",label:"Definición Corta","label-for":"input-default"}},[n("b-form-input",{attrs:{id:"input-default"},model:{value:t.infoMantenimiento.description,callback:function(e){t.$set(t.infoMantenimiento,"description",e)},expression:"infoMantenimiento.description"}})],1),t._v(" "),n("b-form-group",{attrs:{"label-cols-sm":"12","label-cols-md":"5","label-cols-lg":"3",label:"Prioridad","label-for":"input-default"}},[n("b-select",{model:{value:t.infoMantenimiento.priority,callback:function(e){t.$set(t.infoMantenimiento,"priority",e)},expression:"infoMantenimiento.priority"}},[n("option",{attrs:{value:"alta"}},[t._v("Alta")]),t._v(" "),n("option",{attrs:{value:"media"}},[t._v("Media")]),t._v(" "),n("option",{attrs:{value:"baja"}},[t._v("Baja")])])],1),t._v(" "),n("b-form-group",{attrs:{"label-cols":"12",label:"Descripción"}},[n("b-form-textarea",{attrs:{id:"textarea",placeholder:"Descripción...",rows:"3","max-rows":"6"},model:{value:t.infoMantenimiento.problem_definition,callback:function(e){t.$set(t.infoMantenimiento,"problem_definition",e)},expression:"infoMantenimiento.problem_definition"}})],1),t._v(" "),n("div",{staticClass:"text-right"},[n("b-button",{attrs:{size:"md",variant:"success"},on:{click:function(e){return t.savePlan()}}},[t._v("Guardar")])],1)],1),t._v(" "),n("b-table",{staticClass:"mt-3",attrs:{small:"","show-empty":"",stacked:"md",fields:t.mantenimientoColumns,items:t.mantenimientoTableData},scopedSlots:t._u([{key:"cell(description)",fn:function(e){return[t._v("\n            "+t._s(e.item.description)+"      "),n("b-badge",{attrs:{variant:t.getInfoState(e.item.state,"color")}},[t._v(t._s(t.getInfoState(e.item.state,"text")))])]}},{key:"cell(priority)",fn:function(e){return[n("b-badge",{attrs:{variant:t.getInfoState(e.item.priority,"priority")}},[t._v(t._s(e.item.priority))])]}},{key:"cell(edit)",fn:function(e){return[n("div",{staticClass:"text-left"},[n("b-dd",{attrs:{variant:"default",text:"Acciones",right:t.isRTL,size:"xs"}},[t.accessControl(e.item.state,"edit")?n("b-dd-item",{on:{click:function(n){return n.preventDefault(),t.editOrden(e.item)}}},[n("i",{staticClass:"ion ion-md-create text-success"}),t._v("   Editar")]):t._e(),t._v(" "),"PV"==e.item.state?n("b-dd-item",{on:{click:function(n){return n.preventDefault(),t.openActionConfirm(e.item,"AC")}}},[n("i",{staticClass:"ion ion-md-create text-success"}),t._v("   Reabrir Solicitud")]):t._e(),t._v(" "),n("b-dd-divider"),t._v(" "),t.accessControl(e.item.state,"edit")?n("b-dd-item",{on:{click:function(n){return n.preventDefault(),t.openActionConfirm(e.item,"CN")}}},[n("i",{staticClass:"ion ion-md-close text-danger"}),t._v("   Cancelar")]):t._e(),t._v(" "),"PV"==e.item.state?n("b-dd-item",{on:{click:function(n){return n.preventDefault(),t.openActionConfirm(e.item,"CE")}}},[n("i",{staticClass:"ion ion-md-checkmark text-danger"}),t._v("   Terminar Solicitud")]):t._e()],1)],1)]}}])}),t._v(" "),n("b-modal",{attrs:{"hide-footer":"",centered:"",title:"Confirmación de Acción"},model:{value:t.actionConfirm,callback:function(e){t.actionConfirm=e},expression:"actionConfirm"}},[n("h3",{class:"AC"==t.infoDetalleMant.new_state?"text-success text-center":"text-danger text-center"},[t._v(t._s("AC"==t.infoDetalleMant.new_state?"Liberar Orden de Trabajo":"Terminar la Solicitud"))]),t._v(" "),n("h4",{staticClass:"text-center"},[t._v("¿Desea Continuar?")]),t._v(" "),n("b-form-group",{attrs:{"label-cols":"12",label:""}},[n("b-form-textarea",{attrs:{id:"textarea",placeholder:"Detalle...",rows:"3","max-rows":"6"},model:{value:t.infoDetalleMant.comment,callback:function(e){t.$set(t.infoDetalleMant,"comment",e)},expression:"infoDetalleMant.comment"}})],1),t._v(" "),n("hr"),t._v(" "),n("div",{staticClass:"text-right"},[n("b-button",{attrs:{size:"md",variant:"secondary"},on:{click:function(e){t.actionConfirm=!1}}},[t._v("Cancelar")]),t._v(" "),n("b-button",{attrs:{size:"md",variant:"AC"==t.infoDetalleMant.new_state?"success":"danger",disabled:"AC"!=t.infoDetalleMant.new_state&&(""==t.infoDetalleMant.comment||null==this.infoDetalleMant.comment)},on:{click:function(e){t.updateState(),t.actionConfirm=!1}}},[t._v("Confirmar")])],1)],1)],1)},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"switcher-indicator"},[n("span",{staticClass:"switcher-yes"},[n("span",{staticClass:"ion ion-md-checkmark"})]),t._v(" "),n("span",{staticClass:"switcher-no"},[n("span",{staticClass:"ion ion-md-close"})])])}],o=n("8e5f"),s=n.n(o),r=(n("86c7"),n("9b97"));var l={components:{Multiselect:s.a},metaInfo:{title:"Control de Solicitudes"},data:function(){return{tableAssets:[],objinfo:{},infoMantenimiento:{plan_id:0,assets_id:null,description:null,priority:null,problem_definition:null},mantConfig:!1,infoDetalleMant:{comment:null},actionConfirm:!1,active_requests:!0,mantenimientoTableData:[],mantenimientoColumns:[{key:"plan_id",label:"OT"},{key:"code",label:"Activo"},{key:"description",label:"Descripción"},{key:"chart_created",label:"Fecha de Creacion"},{key:"date_last_state_change",label:"Ultimo Estado"},{key:"username",label:"Usuario"},{key:"maintenance_type",label:"Tipo"},{key:"priority",label:"Prioridad"},{key:"edit",label:"Editar"}]}},methods:{getInfoState:function(t,e){return"color"==e?r["a"].getColorState(t):"text"==e?r["a"].getTextState(t):"priority"==e?r["a"].getPriority(t):void 0},updateState:function(){var t=this;r["a"].plan(this.infoDetalleMant,"plan","update-state").then((function(e){t.loadInfo()}))},openActionConfirm:function(t,e){this.infoDetalleMant=t,this.infoDetalleMant.new_state=e,this.actionConfirm=!0},accessControl:function(t,e){return"CR"==t?"edit"==e||"cancelar"==e||"iniciar"==e:"CN"!=t&&"NA"!=t&&("CN"==t?"iniciar"==e:void 0)},editOrden:function(t){this.mantConfig=!0,this.infoMantenimiento=t;for(var e=0;e<this.tableAssets.length;e++){var n=this.tableAssets[e];n.assets_id==t.assets_id&&(this.objinfo=n)}},newRequest:function(){this.infoMantenimiento={plan_id:0,assets_id:null,description:null,priority:null,problem_definition:null,hours_duration:0,comment:""},this.objinfo={},this.mantConfig=!0},savePlan:function(){var t=this;this.infoMantenimiento.assets_id=this.objinfo.assets_id,this.infoMantenimiento.state="CR",this.infoMantenimiento.maintenance_type="solicitud",r["a"].plan(this.infoMantenimiento,"plan-request",0==this.infoMantenimiento.plan_id?"insert":"update").then((function(e){t.loadInfo()}))},changeRequestsState:function(t){this.loadInfo()},loadInfo:function(){var t=this;r["a"].plan([],"plan-request",this.active_requests?"select-active":"select-deactive").then((function(e){t.mantenimientoTableData=[],""!=e.data&&(t.mantenimientoTableData=e.data)}))}},created:function(){var t=this;this.loadInfo(),r["a"].assets([],"select").then((function(e){""!=e.data?t.tableAssets=e.data:t.tableAssets=[]}))}},c=l,u=(n("60bc"),n("2877")),d=Object(u["a"])(c,i,a,!1,null,null,null);e["default"]=d.exports},"9b97":function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("bc3a"),a=n.n(i),o=n("86c7"),s={headers:{Authorization:null==localStorage.getItem("syncbox.cloud")?"":JSON.parse(localStorage.getItem("syncbox.cloud")).token}},r={categories:function(t,e){return a.a.post(o["e"]+"categoriescontrol/"+e,t,s)},assets:function(t,e){return a.a.post(o["e"]+"assetscontrol/"+e,t,s)},assetsParts:function(t,e){return a.a.post(o["e"]+"assetspartscontrol/"+e,t,s)},durationProducts:function(t,e){return a.a.post(o["e"]+"durationsproducts/"+e,t,s)},plan:function(t,e,n){return a.a.post(o["e"]+"plan/"+e+"/"+n,t,s)},registroDatos:function(t,e,n,i){return a.a.post(o["e"]+"durationcontrol/"+e+"/"+n+"/"+i,t,s)},invLinea:function(){return a.a.get(o["e"]+"invlinea",s)},loadoperators:function(t,e){return a.a.post(o["e"]+"eventsoperators/"+t,e,s)},getColorState:function(t){return"CR"==t?"default":"CN"==t?"dark":"AC"==t?"info":"CE"==t?"secondary":"FI"==t?"success":"NA"==t?"danger":"EO"==t||"PV"==t?"warning":void 0},getTextState:function(t){return"CR"==t?"Creado":"CN"==t?"Cancelado":"AC"==t?"Activo":"CE"==t?"Terminado":"FI"==t?"Finalizado":"NA"==t?"No Autorizado":"EO"==t?"En Operacion":"PV"==t?"Por Verificar":void 0},getPriority:function(t){return"alta"==t?"danger":"media"==t?"warning":"baja"==t?"info":void 0}}}}]);
//# sourceMappingURL=chunk-6a54f466.ea5be1e8.js.map